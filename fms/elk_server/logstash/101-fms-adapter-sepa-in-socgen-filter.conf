filter {
    if "fms-adapter-sepa-in-socgen" in [tags] {
       grok {
         match => { "message" => "%{TIMESTAMP_ISO8601:[fms][Adapters][SEPAInMsgSG][timestamp]} %{LOGLEVEL:[fms][Adapters][SEPAInMsgSG][level]}\s+%{WORD:[fms][Adapters][SEPAInMsgSG][operation]}\(%{DATA:[fms][Adapters][SEPAInMsgSG][class]}\) %{WORD:[fms][Adapters][SEPAInMsgSG][operationnext]}\|%{GREEDYDATA:[fms][Adapters][SEPAInMsgSG][message]}" }
         
         match => { "message" => "%{TIMESTAMP_ISO8601:[fms][Adapters][SEPAInMsgSG][timestamp]} %{LOGLEVEL:[fms][Adapters][SEPAInMsgSG][level]}\s+%{WORD:[fms][Adapters][SEPAInMsgSG][operation]}\(%{DATA:[fms][Adapters][SEPAInMsgSG][class]}\) %{GREEDYDATA:[fms][Adapters][SEPAInMsgSG][message]}" }
       }
       mutate {
          remove_tag => [ "beats_input_codec_plain_applied" ]
          add_tag => [ "FMS.log.001" ]
        }
   }
}
