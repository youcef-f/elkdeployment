filter {
    if "fms-adapter-sepa-out-socgen" in [tags] {
       grok {

         match => { "message" => "%{TIMESTAMP_ISO8601:[fms][Adapters][SEPAOutMsgSG][timestamp]} %{LOGLEVEL:[fms][Adapters][SEPAOutMsgSG][level]}\s+%{WORD:[fms][Adapters][SEPAOutMsgSG][operation]}\(%{DATA:[fms][Adapters][SEPAOutMsgSG][class]}\) %{WORD:[fms][Adapters][SEPAOutMsgSG][operationnext]}\|%{GREEDYDATA:[fms][Adapters][SEPAOutMsgSG][message]}" }

        
         match => { "message" => "%{TIMESTAMP_ISO8601:[fms][Adapters][SEPAOutMsgSG][timestamp]} %{LOGLEVEL:[fms][Adapters][SEPAOutMsgSG][level]}\s+%{WORD:[fms][Adapters][SEPAOutMsgSG][operation]}\(%{DATA:[fms][Adapters][SEPAOutMsgSG][class]}\) %{GREEDYDATA:[fms][Adapters][SEPAOutMsgSG][message]}" }

       }
       mutate {
          remove_tag => [ "beats_input_codec_plain_applied" ]
          add_tag => [ "FMS.log.002" ]
        }
   }
}
