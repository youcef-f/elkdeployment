filter {
   
 
    if "fms-adapter-swift-in-bnpp" in [tags] {

      grok {

           match => { "message" => "%{TIMESTAMP_ISO8601:[fms][Adapters][SWIFTInMsgSG][timestamp]} %{LOGLEVEL:[fms][Adapters][SWIFTInMsgSG][level]}\s+%{WORD:[fms][Adapters][SWIFTInMsgSG][operation]}\(%{DATA:[fms][Adapters][SWIFTInMsgSG][class]}\) %{WORD:[fms][Adapters][SWIFTInMsgSG][operationnext]}\|%{GREEDYDATA:[fms][Adapters][SWIFTInMsgSG][message]}" }  
           match => { "message" => "%{TIMESTAMP_ISO8601:[fms][Adapters][SWIFTInMsgSG][timestamp]} %{LOGLEVEL:[fms][Adapters][SWIFTInMsgSG][level]}\s+%{WORD:[fms][Adapters][SWIFTInMsgSG][operation]}\(%{DATA:[fms][Adapters][SWIFTInMsgSG][class]}\) %{GREEDYDATA:[fms][Adapters][SWIFTInMsgSG][message]}" } 
      }

      date {
           # 2013-09-23T11:27:14.177+0200
           match => [
              "timestamp", "yyyy-MM-dd'T'HH:mm:ss.SSSZ"
           ]
      }


      mutate {
        
         add_tag => [ "FMS.log.006" ]

         remove_field => [
            "@version",
            "_score",
            "offset",
            "message"
          ]
      }


      # add tag for monitoring   ( or "error" =~ "/(?i)message/" or "alert" =~ /(?i)message/" or   "fatal" =~ "/(?i)message/" )
      if [level] == "ERROR" or [level] == "ALERT" or [level] == "FATAL"  {
        mutate {
          add_tag => "error"
        }
      }
  
      # remove unneeded tag 
      if "beats_input_codec_plain_applied" in [tags] {
         mutate {  remove_tag => ["beats_input_codec_plain_applied"]  }
     }

   }
}
